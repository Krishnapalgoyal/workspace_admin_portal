<h1 class="text-2xl font-semibold mb-6">Your Organizations</h1>

<div class="mb-4">
  <%= link_to "Create Organization",
      new_organization_path,
      class: "rounded bg-blue-600 px-4 py-2 text-white" %>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
  <% @organizations.each do |org| %>
    <div class="rounded bg-white p-4 shadow border">

      <div class="flex items-center justify-between">
        <h2 class="font-semibold text-lg"><%= org.name %></h2>

        <% if org.google_connected? %>
          <span class="text-xs px-2 py-1 rounded bg-green-100 text-green-700">
            Google Connected
          </span>
        <% else %>
          <span class="text-xs px-2 py-1 rounded bg-red-100 text-red-700">
            Google Not Connected
          </span>
        <% end %>
      </div>

      <p class="text-sm text-gray-500 mt-1">
        Role:
        <strong>
          <%= org.organization_memberships.find_by(user: current_user).role %>
        </strong>
      </p>

      <div class="mt-4 flex gap-2">

        <!-- Enter Organization -->
        <%= button_to "Enter",
            switch_organization_path(organization_id: org.id),
            method: :post,
            class: "rounded bg-gray-800 px-3 py-2 text-white" %>

        <!-- Google Connect / Manage -->
        <% if org.google_connected? %>
          <%= link_to "Manage Google",
              dashboard_path,
              class: "rounded border px-3 py-2 text-gray-700" %>
        <% else %>
          <% if current_organization == org %>
            <% unless org.google_connected? %>
              <%= link_to "Connect Google",
                  connect_google_path,
                  class: "rounded bg-blue-600 px-3 py-2 text-white" %>
            <% end %>
          <% end %>
        <% end %>

      </div>
    </div>
  <% end %>
</div>
